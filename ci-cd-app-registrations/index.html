
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://azure.github.io/enterprise-azure-policy-as-code/ci-cd-app-registrations/">
      
      
        <link rel="prev" href="../ci-cd-overview/">
      
      
        <link rel="next" href="../ci-cd-ado-pipelines/">
      
      
      <link rel="icon" href="../Images/10316-icon-service-Policy.svg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>App Registrations Setup - Enterprise Policy As Code (EPAC)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#app-registrations-setup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Enterprise Policy As Code (EPAC)" class="md-header__button md-logo" aria-label="Enterprise Policy As Code (EPAC)" data-md-component="logo">
      
  <img src="../Images/10316-icon-service-Policy.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Enterprise Policy As Code (EPAC)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              App Registrations Setup
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Azure/enterprise-azure-policy-as-code" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../epac-implementing/" class="md-tabs__link">
          
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../settings-global-setting-file/" class="md-tabs__link">
          
  
    
  
  Settings and Desired State

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../policy-definitions/" class="md-tabs__link">
          
  
    
  
  Define Policy Resources

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../integrating-with-alz/" class="md-tabs__link">
          
  
    
  
  Azure Landing Zones

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ci-cd-overview/" class="md-tabs__link">
          
  
    
  
  CI/CD Integration

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../operational-scripts/" class="md-tabs__link">
          
  
    
  
  Operational Scripts

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Enterprise Policy As Code (EPAC)" class="md-nav__button md-logo" aria-label="Enterprise Policy As Code (EPAC)" data-md-component="logo">
      
  <img src="../Images/10316-icon-service-Policy.svg" alt="logo">

    </a>
    Enterprise Policy As Code (EPAC)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Azure/enterprise-azure-policy-as-code" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../epac-implementing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../epac-extracting-policy-resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extracting Policy Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../epac-forking-github-repo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forking GitHub Repo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Settings and Desired State
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Settings and Desired State
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings-global-setting-file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings-desired-state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desired State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings-dfc-assignments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DfC Assignments
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Define Policy Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Define Policy Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-definitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Definitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-set-definitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Set Definitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-assignments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Assignment Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-assignments-csv-parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSV Assignment Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-exemptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Exemptions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Azure Landing Zones
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Azure Landing Zones
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrating-with-alz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ALZ Policy Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrating-with-alz-monitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Monitor Baseline Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrating-with-slz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sovereign Landing Zones
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CI/CD Integration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            CI/CD Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI/CD Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    App Registrations Setup
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    App Registrations Setup
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-epac-resource-policy-reader-role" class="md-nav__link">
    <span class="md-ellipsis">
      Custom EPAC Resource Policy Reader Role
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-single-app-registration-and-role-assignments-for-epac-dev" class="md-nav__link">
    <span class="md-ellipsis">
      Create single App Registration and Role assignments for epac-dev
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create single App Registration and Role assignments for epac-dev">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-app-registration-for-epac-dev-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Create the App Registration for epac-dev environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-necessary-microsoft-graph-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the necessary Microsoft Graph permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-necessary-azure-owner-permissions-for-the-epac-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the necessary Azure Owner permissions for the epac Management Group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-app-registrations-and-role-assignments-for-prod-environments-per-tenant" class="md-nav__link">
    <span class="md-ellipsis">
      Create App Registrations and Role assignments for prod environments (per tenant)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create App Registrations and Role assignments for prod environments (per tenant)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#app-registration-with-permissions-to-read-policy-resources-and-azure-roles" class="md-nav__link">
    <span class="md-ellipsis">
      App Registration with permissions to read Policy resources and Azure roles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="App Registration with permissions to read Policy resources and Azure roles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-app-registration-the-same-as-above-with-the-same-microsoft-graph-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Create the App Registration the same as above with the same Microsoft Graph permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-custom-azure-role-with-permissions-to-read-policy-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Create custom Azure role with permissions to read Policy resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-custom-azure-role-at-the-root-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the custom Azure role at the root Management Group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app-registration-with-permissions-to-deploy-policy-resources" class="md-nav__link">
    <span class="md-ellipsis">
      App Registration with permissions to deploy Policy resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-app-registration-without-microsoft-graph-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Create the App Registration without Microsoft Graph permissions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create the App Registration without Microsoft Graph permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-resourcepolicy-contributor-role-at-the-root-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the ResourcePolicy Contributor role at the root Management Group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app-registration-with-permissions-to-assign-roles-at-root-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      App Registration with permissions to assign Roles at root Management Group
    </span>
  </a>
  
    <nav class="md-nav" aria-label="App Registration with permissions to assign Roles at root Management Group">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-app-registration-the-same-as-above-with-the-same-microsoft-graph-permissions_1" class="md-nav__link">
    <span class="md-ellipsis">
      Create the App Registration the same as above with the same Microsoft Graph permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-user-access-administrator-role-at-the-root-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the User Access Administrator role at the root Management Group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd-ado-pipelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure DevOps Pipelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd-github-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Actions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operational Scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Operational Scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operational-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scripts Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operational-scripts-documenting-policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documenting Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operational-scripts-hydration-kit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hydration Kit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operational-scripts-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-epac-resource-policy-reader-role" class="md-nav__link">
    <span class="md-ellipsis">
      Custom EPAC Resource Policy Reader Role
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-single-app-registration-and-role-assignments-for-epac-dev" class="md-nav__link">
    <span class="md-ellipsis">
      Create single App Registration and Role assignments for epac-dev
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create single App Registration and Role assignments for epac-dev">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-app-registration-for-epac-dev-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Create the App Registration for epac-dev environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-necessary-microsoft-graph-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the necessary Microsoft Graph permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-necessary-azure-owner-permissions-for-the-epac-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the necessary Azure Owner permissions for the epac Management Group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-app-registrations-and-role-assignments-for-prod-environments-per-tenant" class="md-nav__link">
    <span class="md-ellipsis">
      Create App Registrations and Role assignments for prod environments (per tenant)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create App Registrations and Role assignments for prod environments (per tenant)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#app-registration-with-permissions-to-read-policy-resources-and-azure-roles" class="md-nav__link">
    <span class="md-ellipsis">
      App Registration with permissions to read Policy resources and Azure roles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="App Registration with permissions to read Policy resources and Azure roles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-app-registration-the-same-as-above-with-the-same-microsoft-graph-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Create the App Registration the same as above with the same Microsoft Graph permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-custom-azure-role-with-permissions-to-read-policy-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Create custom Azure role with permissions to read Policy resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-custom-azure-role-at-the-root-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the custom Azure role at the root Management Group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app-registration-with-permissions-to-deploy-policy-resources" class="md-nav__link">
    <span class="md-ellipsis">
      App Registration with permissions to deploy Policy resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-app-registration-without-microsoft-graph-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Create the App Registration without Microsoft Graph permissions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create the App Registration without Microsoft Graph permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-resourcepolicy-contributor-role-at-the-root-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the ResourcePolicy Contributor role at the root Management Group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app-registration-with-permissions-to-assign-roles-at-root-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      App Registration with permissions to assign Roles at root Management Group
    </span>
  </a>
  
    <nav class="md-nav" aria-label="App Registration with permissions to assign Roles at root Management Group">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-app-registration-the-same-as-above-with-the-same-microsoft-graph-permissions_1" class="md-nav__link">
    <span class="md-ellipsis">
      Create the App Registration the same as above with the same Microsoft Graph permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-the-app-registration-the-user-access-administrator-role-at-the-root-management-group" class="md-nav__link">
    <span class="md-ellipsis">
      Grant the App Registration the User Access Administrator role at the root Management Group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="app-registrations-setup">App Registrations Setup</h1>
<p>CI/CD pipelines/workflows require the creation of App Registrations in your Entra ID (Azure AD) tenants. The App Registrations are used by the EPAC pipeline to deploy the EPAC Management Group and the EPAC Management Group Policy Definitions.</p>
<p>The following screenshot shows the Management Group hierarchy that used for the App Registrations.</p>
<p><img alt="Management Group hierarchy" src="../Images/ci-cd-mg.png" /></p>
<h2 id="custom-epac-resource-policy-reader-role">Custom <code>EPAC Resource Policy Reader Role</code></h2>
<p>EPAC uses a set of Entra ID App Registrations (Service Principals). To build the deployment plan and adhere to the least-privilege-principle, a Resource Policy Reader role is required. This role is not built-in. EPAC contains script <code>New-AzPolicyReaderRole</code> to create this role or you can use the below JSON in Azure Portal.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;roleName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EPAC Resource Policy Reader&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Provides read access to all Policy resources for the purpose of planning the EPAC deployments.&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;assignableScopes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;/&quot;</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;actions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="s2">&quot;Microsoft.Authorization/policyassignments/read&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;Microsoft.Authorization/policydefinitions/read&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;Microsoft.Authorization/policyexemptions/read&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;Microsoft.Authorization/policysetdefinitions/read&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;Microsoft.Authorization/roleAssignments/read&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;Microsoft.PolicyInsights/*&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;Microsoft.Management/register/action&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;Microsoft.Management/managementGroups/read&quot;</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">                </span><span class="nt">&quot;notActions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">                </span><span class="nt">&quot;dataActions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">                </span><span class="nt">&quot;notDataActions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="create-single-app-registration-and-role-assignments-for-epac-dev">Create single App Registration and Role assignments for <code>epac-dev</code></h2>
<p>Create the App Registrations for:</p>
<ul>
<li>epac-dev environment with Owner rights to the epac-dev Management Group</li>
<li>Optional: epac-test environment with Owner rights to the epac-test Management Group (repeat the steps below for epac-test)</li>
</ul>
<h3 id="create-the-app-registration-for-epac-dev-environment">Create the App Registration for <code>epac-dev</code> environment</h3>
<p><img alt="App Registration 1" src="../Images/ci-cd-app-reg-perm-1.png" /></p>
<h3 id="grant-the-app-registration-the-necessary-microsoft-graph-permissions">Grant the App Registration the necessary Microsoft Graph permissions</h3>
<p><img alt="App Registration 2" src="../Images/ci-cd-app-reg-perm-2.png" /></p>
<p><img alt="App Registration 3" src="../Images/ci-cd-app-reg-perm-3.png" /></p>
<p><img alt="App Registration 4" src="../Images/ci-cd-app-reg-perm-4.png" /></p>
<p><img alt="App Registration 5" src="../Images/ci-cd-app-reg-perm-5.png" /></p>
<p><img alt="App Registration 6" src="../Images/ci-cd-app-reg-perm-6.png" /></p>
<p><img alt="App Registration 7" src="../Images/ci-cd-app-reg-perm-7.png" /></p>
<p><img alt="App Registration 8" src="../Images/ci-cd-app-reg-perm-8.png" /></p>
<p><img alt="App Registration 9" src="../Images/ci-cd-app-reg-perm-9.png" /></p>
<p><img alt="App Registration 10" src="../Images/ci-cd-app-reg-perm-a.png" /></p>
<h3 id="grant-the-app-registration-the-necessary-azure-owner-permissions-for-the-epac-management-group">Grant the App Registration the necessary Azure <code>Owner</code> permissions for the epac Management Group</h3>
<p><img alt="App Registration 11" src="../Images/ci-cd-app-reg-perm-b.png" /></p>
<p><img alt="App Registration 12" src="../Images/ci-cd-app-reg-perm-c.png" /></p>
<p><img alt="App Registration 13" src="../Images/ci-cd-app-reg-perm-d1.png" /></p>
<p><img alt="App Registration 14" src="../Images/ci-cd-app-reg-perm-d2.png" /></p>
<p><img alt="App Registration 15" src="../Images/ci-cd-app-reg-perm-d3.png" /></p>
<p><img alt="App Registration 16" src="../Images/ci-cd-app-reg-perm-d4.png" /></p>
<p><img alt="App Registration 17" src="../Images/ci-cd-app-reg-perm-d5.png" /></p>
<h2 id="create-app-registrations-and-role-assignments-for-prod-environments-per-tenant">Create App Registrations and Role assignments for prod environments (per tenant)</h2>
<h3 id="app-registration-with-permissions-to-read-policy-resources-and-azure-roles">App Registration  with permissions to read Policy resources and Azure roles</h3>
<h4 id="create-the-app-registration-the-same-as-above-with-the-same-microsoft-graph-permissions">Create the App Registration the same as above with the same Microsoft Graph permissions</h4>
<p><img alt="App Registration" src="../Images/ci-cd-app-reg-root-reader.png" /></p>
<h4 id="create-custom-azure-role-with-permissions-to-read-policy-resources">Create custom Azure role with permissions to read Policy resources</h4>
<p><img alt="Reader Role 18" src="../Images/ci-cd-role-policy-reader-1.png" /></p>
<p><img alt="Reader Role 19" src="../Images/ci-cd-role-policy-reader-2.png" /></p>
<p><img alt="Reader Role 20" src="../Images/ci-cd-role-policy-reader-3.png" /></p>
<p><img alt="Reader Role 21" src="../Images/ci-cd-role-policy-reader-4.png" /></p>
<p><img alt="Reader Role 22" src="../Images/ci-cd-role-policy-reader-5.png" /></p>
<h4 id="grant-the-app-registration-the-custom-azure-role-at-the-root-management-group">Grant the App Registration the custom Azure role at the root Management Group</h4>
<p><img alt="App Registration 23" src="../Images/ci-cd-app-reg-root-reader-perm-1.png" /></p>
<p><img alt="App Registration 24" src="../Images/ci-cd-app-reg-root-reader-perm-2.png" /></p>
<h3 id="app-registration-with-permissions-to-deploy-policy-resources">App Registration with permissions to deploy Policy resources</h3>
<h3 id="create-the-app-registration-without-microsoft-graph-permissions">Create the App Registration <strong><em>without</em></strong> Microsoft Graph permissions</h3>
<p><img alt="App Registration 25" src="../Images/ci-cd-app-reg-root-contributor.png" /></p>
<h4 id="grant-the-app-registration-the-resourcepolicy-contributor-role-at-the-root-management-group">Grant the App Registration the <code>ResourcePolicy Contributor</code> role at the root Management Group</h4>
<p><img alt="App Registration 26" src="../Images/ci-cd-app-reg-root-contributor-perm-1.png" /></p>
<p><img alt="App Registration 27" src="../Images/ci-cd-app-reg-root-contributor-perm-2.png" /></p>
<h3 id="app-registration-with-permissions-to-assign-roles-at-root-management-group">App Registration with permissions to assign Roles at root Management Group</h3>
<h4 id="create-the-app-registration-the-same-as-above-with-the-same-microsoft-graph-permissions_1">Create the App Registration the same as above with the same Microsoft Graph permissions</h4>
<p><img alt="App Registration 28" src="../Images/ci-cd-app-reg-root-roles.png" /></p>
<h4 id="grant-the-app-registration-the-user-access-administrator-role-at-the-root-management-group">Grant the App Registration the <code>User Access Administrator</code> role at the root Management Group</h4>
<p><img alt="App Registration 29" src="../Images/ci-cd-app-reg-root-role-assignments-perm-1.png" /></p>
<p><img alt="App Registration 30" src="../Images/ci-cd-app-reg-root-role-assignments-perm-2.png" /></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.indexes", {"navigation.sections": {"level": 1}}, "navigation.tabs", "navigation.tabs.sticky", "content.code.annotate", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>